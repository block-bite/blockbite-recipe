(function(c,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(c=typeof globalThis<"u"?globalThis:c||self,n(c.Recipe={}))})(this,function(c){"use strict";var A=Object.defineProperty;var v=(c,n,m)=>n in c?A(c,n,{enumerable:!0,configurable:!0,writable:!0,value:m}):c[n]=m;var q=(c,n,m)=>v(c,typeof n!="symbol"?n+"":n,m);const _=class _{constructor(a,s,r={}){if(a==="store"){this._isStore=!0,this._storeName=r.name||"store",this._useLocalStorage=r.localStorage||!1,this.store=this._initStore(s),this.watch=(t,e)=>{var o;this._storeWatchers??(this._storeWatchers={}),(o=this._storeWatchers)[t]??(o[t]=[]),this._storeWatchers[t].push(e)},_.store.set(this._storeName,this.store),_._storeInstanceMap??(_._storeInstanceMap=new Map),_._storeInstanceMap.set(this._storeName,this);return}this.root=document.querySelector(a),this.queue=[],this.watchers={},this._state={},this._stateWatchers={},this.store=new Proxy({},{set:(t,e,o)=>{var i,h;if(t[e]=o,!isNaN(e)||e==="length"){this._saveStore(t),subscribers.forEach(l=>l(t));const f=(i=_._storeInstanceMap)==null?void 0:i.get(this._storeName),g=(h=f==null?void 0:f._storeWatchers)==null?void 0:h[e];g&&g.forEach(l=>{var d;l(o,(d=f._getRuntime)==null?void 0:d.call(f,document.body))})}return!0},get:(t,e)=>t[e]}),setTimeout(()=>this._runQueue(),0)}text(a,s){const r=this.root.querySelector(`[r-text="${a}"]`)||this.root.querySelector(`[data-r-text="${a}"]`);r&&(r.textContent=s)}loop(){const a=this.root.querySelector("[r-loop]");if(!a)return{effect:()=>{},click:()=>{}};const s=a.parentElement,r=a.cloneNode(!0),t=[],e={effect:(o,i=[])=>{const h=f=>{s.querySelectorAll("[data-r-loop-item]").forEach(g=>g.remove()),f.forEach((g,l)=>{const d=r.cloneNode(!0);d.removeAttribute("r-loop"),d.setAttribute("data-r-loop-item",""),d.setAttribute("data-r-item",JSON.stringify(g)),i.forEach(E=>{const S=d.querySelector(`[r-text="${E}"]`);S&&(S.textContent=g[E])}),t.forEach(({selector:E,handler:S})=>{d.querySelectorAll(E).forEach(p=>{p.addEventListener("click",()=>{const w=this._getRuntime(p);S(l,w)})})}),s.appendChild(d)})};return o!=null&&o.__subscribe&&o.__subscribe(h),h(o),a.remove(),e},click:o=>i=>(t.push({selector:o,handler:i}),e)};return e}_initStore(a){let s=null;if(this._useLocalStorage){const o=localStorage.getItem(this._storeName);if(o)try{s=JSON.parse(o)}catch{console.warn("ðŸ“š Recipe Failed to parse localStorage for store:",this._storeName)}}const r=s||a,t=[],e=new Proxy([...r],{set:(o,i,h)=>{var f;if(o[i]=h,!isNaN(i)||i==="length"){this._saveStore(o),t.forEach(l=>l(o));const g=(f=this._storeWatchers)==null?void 0:f[i];g&&g.forEach(l=>{var d;l(h,(d=this._getRuntime)==null?void 0:d.call(this,document.body))})}return!0},get:(o,i)=>i==="__subscribe"?h=>t.push(h):o[i]});return this._saveStore(e),e}_saveStore(a){this._useLocalStorage&&localStorage.setItem(this._storeName,JSON.stringify(a))}bindMouseEvent(a){const s=this;return r=>(s.queue.push(()=>{(a?s.root.querySelectorAll(a):[s.root]).forEach((e,o)=>{if(!e){console.warn(`ðŸ“š Recipe Element not found: ${a}`);return}e.addEventListener("click",()=>{const i=s._getRuntime(e);r(i,o)})})}),s)}click(a){return this.bindMouseEvent(a)}mouseover(a){return this.bindMouseEvent(a)}mouseout(a){return this.bindMouseEvent(a)}watch(a,s){this.watchers[a]=(r,t)=>s(r,t)}_runQueue(){this.queue.forEach(a=>a()),this.queue=[]}_getRuntime(a){const s=this;return{el:a,class:{add:r=>a.classList.add(r),remove:r=>a.classList.remove(r)},q(r){const t=s.root||document;return b(t.querySelectorAll(r),s)},data:{set:(r,t)=>{var e;s._state[r]=t,a==null||a.setAttribute(`data-${r}`,t),(e=s._stateWatchers)!=null&&e[r]&&s._stateWatchers[r].forEach(o=>o(t))},get:r=>s._state[r],watch:r=>t=>{var e;s._stateWatchers??(s._stateWatchers={}),(e=s._stateWatchers)[r]??(e[r]=[]),s._stateWatchers[r].push(t)}},parent(r){const t=r?a.closest(r):a.parentElement;return{data:{set:(e,o)=>{var i;s._state[e]=o,t==null||t.setAttribute(`data-${e}`,o),(i=s._stateWatchers)!=null&&i[e]&&s._stateWatchers[e].forEach(h=>h(o))},get:e=>s._state[e],watch:e=>o=>{var i;s._stateWatchers??(s._stateWatchers={}),(i=s._stateWatchers)[e]??(i[e]=[]),s._stateWatchers[e].push(o)}}}},getItem(){var t;const r=a.getAttribute("data-r-item")||((t=a.closest("[data-r-item]"))==null?void 0:t.getAttribute("data-r-item"));try{return r?JSON.parse(r):null}catch{return console.warn("ðŸ“š Recipe Failed to parse data-r-item:",r),null}}}}};q(_,"store",new Map);let n=_;const m={};function b(u,a){const s=(a==null?void 0:a._stateWatchers)??m;return{class:{add(r){return u.forEach(t=>t.classList.add(r)),this},remove(r){return u.forEach(t=>t.classList.remove(r)),this},toggle(r){return u.forEach(t=>t.classList.toggle(r)),this}},data:{set(r,t){return u.forEach(e=>{e.setAttribute(`data-${r}`,t),s!=null&&s[r]&&s[r].forEach(o=>o(t))}),this},get(r){var t;return(t=u[0])==null?void 0:t.getAttribute(`data-${r}`)},watch(r){return t=>{s[r]??(s[r]=[]),s[r].push(t)}}},click(r){return u.forEach(t=>t.addEventListener("click",e=>r(e,t))),this},mouseover(r){return u.forEach(t=>t.addEventListener("mouseover",e=>r(e,t))),this},mouseout(r){return u.forEach(t=>t.addEventListener("mouseout",e=>r(e,t))),this},eq(r){const t=u[r];return{el:t,class:{add:e=>(t==null||t.classList.add(e),this),remove:e=>(t==null||t.classList.remove(e),this),toggle:e=>(t==null||t.classList.toggle(e),this)},text(e,o){const i=(t==null?void 0:t.querySelector(`[r-text="${e}"]`))||(t==null?void 0:t.querySelector(`[data-r-text="${e}"]`));i&&(i.textContent=o)},data:{set:(e,o)=>(t==null||t.setAttribute(`data-${e}`,o),s!=null&&s[e]&&s[e].forEach(i=>i(o)),this),get:e=>t==null?void 0:t.getAttribute(`data-${e}`),watch:e=>o=>{s[e]??(s[e]=[]),s[e].push(o)}}}},text(r,t){u.forEach(e=>{if(e.getAttribute("r-text")===r||e.getAttribute("data-r-text")===r){e.textContent=t;return}const o=e.querySelector(`[r-text="${r}"]`)||e.querySelector(`[data-r-text="${r}"]`);o&&(o.textContent=t)})}}}window.$r={q(u){return b(document.querySelectorAll(u))},getItem(){return null}},c.Recipe=n,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
